---
layout: post
title: "攻防世界,转轮机加密"
categories: crypto
tags: 古典密码
excerpt: 攻防世界做题的wp，本文章关于转轮机加密。
data: 2021-07-23
author: citytwilight
---



# 题目

https://adworld.xctf.org.cn/task/answer?type=crypto&number=5&grade=0&id=5113&page=1



# 解题过程

#### step1：分析

转轮机加密，也就是wheelcipher  参考：https://www.cnblogs.com/block2016/p/5419894.html

```
1:   < ZWAXJGDLUBVIQHKYPNTCRMOSFE <
2:   < KPBELNACZDTRXMJQOYHGVSFUWI <
3:   < BDMAIZVRNSJUWFHTEQGYXPLOCK <
4:   < RPLNDVHGFCUKTEBSXQYIZMJWAO <
5:   < IHFRLABEUOTSGJVDKCPMNZQWXY <
6:   < AMKGHIWPNYCJBFZDRUSLOQXVET <
7:   < GWTHSPYBXIZULVKMRAFDCEONJQ <
8:   < NOZUTWDCVRJLXKISEFAPMYGHBQ <
9:   < XPLTDSRFHENYVUBMCQWAOIKZGJ <
10:  < UDNAJFBOWTGVRSCZQKELMXYIHP <
11： < MNBVCXZQWERTPOIUYALSKDJFHG <
12： < LVNCMXZPQOWEIURYTASBKJDFHG <
13： < JZQAWSXCDERFVBGTYHNUMKILOP <

密钥为：2,3,7,5,13,12,9,1,8,10,4,11,6
密文为：NFQKSEVOQOFNP
```

转轮机加密由三串字符串组成，第一部分为加密表，第二部分为密钥，第三部分为密文 加密表就是我们需要利用密钥和密文来进行加密，具体的过程如下： 首先查看密钥第一个字符为2，因此我们需要到加密表中去查找第2行的数据 2: < KPBELNACZDTRXMJQOYHGVSFUWI < 这里我们再利用密文的第一个字符N进行旋转，N在这里的作用就是旋转过后的第一个字符即为N，在这里的旋转为循环，不为补0 因此我们可以来对加密表中的第一段密文进行解密：NACZDTRXMJQOYHGVSFUWIKPBEL



#### step2：按照原理操作

```
1： < KPBELNACZDTRXMJQOYHGVSFUWI <
2： < BDMAIZVRNSJUWFHTEQGYXPLOCK <
3： < GWTHSPYBXIZULVKMRAFDCEONJQ <
4： < IHFRLABEUOTSGJVDKCPMNZQWXY <
5： < JZQAWSXCDERFVBGTYHNUMKILOP <
6： < LVNCMXZPQOWEIURYTASBKJDFHG <
7： < XPLTDSRFHENYVUBMCQWAOIKZGJ <
8： < ZWAXJGDLUBVIQHKYPNTCRMOSFE <
9： < NOZUTWDCVRJLXKISEFAPMYGHBQ <
10：< UDNAJFBOWTGVRSCZQKELMXYIHP <
11：< RPLNDVHGFCUKTEBSXQYIZMJWAO <
12：< MNBVCXZQWERTPOIUYALSKDJFHG <
13：< AMKGHIWPNYCJBFZDRUSLOQXVET <
```



#### step3：把每一列列出来(为了方面辨认有意义的以小写展示)

```
1：  nfqksevoqofnp
2：  ahgcxiusnwcbn
3：  ctwpcubfotuvy
4：  zetmdrmezgkcc
5：  dqhneyczuvtxj
6：  tgszrtqwtrezb
7：  rypqfawawsbqf
8：  xxywvsaxdcswz
9：  mpbxbbojczxed
10： jlxygkigvqqrr
11： qoiitjkdrkytu
12： oczhydzljeips
13： ykufhfgullzol
14： hblrnhjbxmmio
15： gdvlugxvkxjuq
16： vmkamlpiiywyx
17： sambkvlqsiaav
18： fireinthehole
19： uzaulcdkfprst
20： wvfoomsyaupka
21： irdtpxrppdldm
22： kncsjzfnmnnjk
23： psegzphtyadfg
24： bjojqqecgjvhh
25： eunvaonrhfhgi
26： lwjdwwymbbgmw
```



#### step4：得到flag

根据题目提示“二战”，只有第18列字符串“fireinthehole”（fire in the hole–小心手雷）比较符合

```
fireinthehole
```



脚本形式：

```
import re

sss = '1: < ZWAXJGDLUBVIQHKYPNTCRMOSFE < 2: < KPBELNACZDTRXMJQOYHGVSFUWI < 3: < BDMAIZVRNSJUWFHTEQGYXPLOCK < 4: < RPLNDVHGFCUKTEBSXQYIZMJWAO < 5: < IHFRLABEUOTSGJVDKCPMNZQWXY < 6: < AMKGHIWPNYCJBFZDRUSLOQXVET < 7: < GWTHSPYBXIZULVKMRAFDCEONJQ < 8: < NOZUTWDCVRJLXKISEFAPMYGHBQ < 9: < XPLTDSRFHENYVUBMCQWAOIKZGJ < 10: < UDNAJFBOWTGVRSCZQKELMXYIHP < 11 < MNBVCXZQWERTPOIUYALSKDJFHG < 12 < LVNCMXZPQOWEIURYTASBKJDFHG < 13 < JZQAWSXCDERFVBGTYHNUMKILOP <'
m = 'NFQKSEVOQOFNP'
# 将sss转化为列表形式
content=re.findall(r'< (.*?) <',sss,re.S)
# re.S:DOTALL，此模式下，"."的匹配不受限制，可匹配任何字符，包括换行符
iv=[2,3,7,5,13,12,9,1,8,10,4,11,6]
print(content)
vvv=[]
for i in range(13):
    index=content[iv[i]-1].index(m[i])
    vvv.append(index)
print(vvv)

for i in range(0,26):
    flag=""
    for j in range(13):
        flag += content[iv[j]-1][(vvv[j]+i)%26]
    print(flag.lower())
```



# 思考总结

一开始看提示托马斯·杰斐逊不知道啥意思，没思路。后来查资料知道了转轮机加密是什么原理，实质是循环置换的多表代换技术，也还是在古典密码范畴内。emmm，古典密码还是得多了解，不然确实有点懵



1.这几天刷的古典密码的题都要转点弯。

2.争取逐步自己写脚本吧，基本上最近的题（手撕也行，但是效率太低了）的脚本都是在别人wp基础上进行修改的





